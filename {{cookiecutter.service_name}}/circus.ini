[circus]
pidfile = {{cookiecutter.service_name}}.pid
endpoint = ipc://{{cookiecutter.service_name}}-endpoint

[watcher:rsyslog]
cmd = /usr/sbin/rsyslogd -n -f rsyslog.conf -i /tmp/{{cookiecutter.service_name}}-rsyslog.pid
stdout_stream.class = FileStream
stdout_stream.filename = circus-rsyslog.log

[watcher:redir-http]
cmd = ./logger redir-http bash -c 'exec env/bin/killable-sudo redir --laddr $(getent hosts {{cookiecutter.exposed_host}} | awk "{print \$1}") --lport {{cookiecutter.external_port}} --caddr localhost --cport {{cookiecutter.internal_port}}'
copy_env = True

[watcher:{{cookiecutter.service_name}}-publish-mdns]
cmd = bash -c 'source env/bin/activate; exec ./logger {{cookiecutter.service_name}}-publish-mdns avahi-publish -a -R {{cookiecutter.service_name}}.local $(getent hosts {{cookiecutter.exposed_host}} | awk "{print \$1}")'
copy_env = True
